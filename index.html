<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>命卦計算器</title>
  <style>
    body {
      font-family: "Microsoft JhengHei", sans-serif;
      background: linear-gradient(to bottom right, #f0f9ff, #dff2ff);
      color: #333;
      padding: 2em;
      display: flex;
      justify-content: center;
    }
    .container {
      background: white;
      padding: 2em 3em;
      border-radius: 12px;
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
      max-width: 400px;
      width: 100%;
    }
    h1 {
      text-align: center;
      color: #1e88e5;
    }
    label {
      margin-top: 1em;
      display: block;
      font-weight: bold;
    }
    input, select {
      width: 100%;
      padding: 0.5em;
      margin-top: 0.5em;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 1em;
    }
    button {
      margin-top: 1.5em;
      padding: 0.6em;
      width: 100%;
      font-size: 1.1em;
      background: #1e88e5;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    button:hover {
      background: #1565c0;
    }
    .result {
      margin-top: 2em;
      font-weight: bold;
      white-space: pre-line;
      background: #e3f2fd;
      padding: 1em;
      border-radius: 6px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>命卦計算器</h1>
    <label for="birthday">出生日期：</label>
    <input type="date" id="birthday" required>

    <label for="gender">性別：</label>
    <select id="gender">
      <option value="male">男性</option>
      <option value="female">女性</option>
    </select>

    <button onclick="calculateMingua()">計算命卦</button>

    <div class="result" id="result"></div>
  </div>

<script>
    const lichunDates = {
      2000: '2000-02-04'
    };

    const kuaMap = {
      1: '坎卦', 2: '坤卦', 3: '震卦', 4: '巽卦',
      5: { male: '坤卦', female: '艮卦' },
      6: '乾卦', 7: '兌卦', 8: '艮卦', 9: '離卦'
    };

    const directions = {
      坎卦: { 生氣: '巽', 天醫: '震', 延年: '離' },
      坤卦: { 生氣: '艮', 天醫: '兌', 延年: '乾' },
      震卦: { 生氣: '離', 天醫: '坎', 延年: '巽' },
      巽卦: { 生氣: '坎', 天醫: '離', 延年: '震' },
      乾卦: { 生氣: '兌', 天醫: '艮', 延年: '坤' },
      兌卦: { 生氣: '乾', 天醫: '坤', 延年: '艮' },
      艮卦: { 生氣: '坤', 天醫: '乾', 延年: '兌' },
      離卦: { 生氣: '震', 天醫: '巽', 延年: '坎' },
    };

    function calculateMingua() {
      const birthStr = document.getElementById("birthday").value;
      const gender = document.getElementById("gender").value;
      const resultDiv = document.getElementById("result");

      if (!birthStr) {
        resultDiv.innerText = '請輸入出生日期';
        return;
      }

      const birthDate = new Date(birthStr);
      let year = birthDate.getFullYear();
      const lichun = new Date(lichunDates[2000]);
      const bornBeforeLichun = birthDate < lichun;
      const y = year % 100;

      let remainder;
      if (bornBeforeLichun) {
        if (gender === 'male') {
          remainder = 100 - y;
        } else {
          remainder = y + 5;
        }
      } else {
        if (gender === 'male') {
          remainder = 99 - y;
        } else {
          remainder = y + 6;
        }
      }

      remainder = remainder % 9;
      if (remainder === 0) remainder = 9;

      let kua;
      if (remainder === 5) {
        kua = kuaMap[5][gender];
      } else {
        kua = kuaMap[remainder];
      }

      if (!kua || !directions[kua]) {
        resultDiv.innerText = `無法找到對應的吉方資料（命卦：${remainder}）。`;
        return;
      }

      const dir = directions[kua];
      resultDiv.innerText =
        `命卦：${kua}\n生氣：${dir.生氣}\n天醫：${dir.天醫}\n延年：${dir.延年}`;
    }
</script>
</body>
</html>
